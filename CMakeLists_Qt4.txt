cmake_minimum_required(VERSION 2.6 FATAL_ERROR)

# Set package properties 
project(ViennaCL_Benchmark)

#disable -rdynamic
SET(CMAKE_SHARED_LIBRARY_LINK_CXX_FLAGS "")
SET(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")

# Find includes in corresponding build directories
set(CMAKE_INCLUDE_CURRENT_DIR ON)
# Instruct CMake to run moc automatically when needed.
set(CMAKE_AUTOMOC ON)

add_definitions(-O2 -D_FILE_OFFSET_BITS=64 -fPIC) 

#show all source files in project
file( GLOB_RECURSE MAKE_HEADERS_VISIBLE_SRC
    *.hpp *.h *.cpp *.qrc *.ui)
add_custom_target( MAKE_HEADERS_VISIBLE SOURCES ${MAKE_HEADERS_VISIBLE_SRC} )

# Set release build:
IF(DEFINED CMAKE_BUILD_TYPE)
 SET (CMAKE_BUILD_TYPE ${CMAKE_BUILD_TYPE})
ELSE()
 SET (CMAKE_BUILD_TYPE Release)
ENDIF()

include_directories(${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR})

#Include ViennaCL
include_directories(" C:/Users/Namik/Documents/GitHub/viennacl-dev")
find_package(ViennaCL QUIET REQUIRED)
include_directories(${VIENNACL_INCLUDE_DIRS})


# this command finds Qt4 libraries and sets all required variables
# note that it's Qt4, not QT4 or qt4
FIND_PACKAGE( Qt4 REQUIRED )
  
# (QT_USE_FILE is a variable defined by FIND_PACKAGE( Qt4 ) that contains a path to CMake script)
INCLUDE( ${QT_USE_FILE} ) 
  
set(Boost_USE_STATIC_LIBS OFF)
set(Boost_USE_MULTITHREADED ON)
set(Boost_USE_STATIC_RUNTIME OFF)
find_package(Boost)

file(GLOB ViennaCL_Benchmark_Sources
    "src/benchmarks/*.cpp"
    "src/*.cpp"
)

file(GLOB ViennaCL_Benchmark_Headers
    "src/benchmarks/*.h"
    "src/benchmarks/*.hpp"
    "src/*.h"
    "src/*.hpp"
)

file(GLOB ViennaCL_Benchmark_Ui_Files
    "src/*.ui"
)

file(GLOB ViennaCL_Benchmark_Resources
    "src/resources/*.qrc"
)

#ADD_DEFINITIONS( -Wall )
#add_definitions( -Wno-unused)
add_definitions( -Wextra)

#Generate ui headers
qt4_wrap_ui(wrapped_ui_headers ${ViennaCL_Benchmark_Ui_Files} )

#Add the resource files
qt4_add_resources(added_resources ${ViennaCL_Benchmark_Resources} )

if(Boost_FOUND)
    include_directories(${Boost_INCLUDE_DIRS})
# Build the app!
    add_executable(ViennaCL_Benchmark ${ViennaCL_Benchmark_Sources} ${ViennaCL_Benchmark_Headers} ${wrapped_ui_headers} ${added_resources} )
    target_link_libraries(ViennaCL_Benchmark ${Boost_LIBRARIES} ${QT_QTMAIN_LIBRARY} ${QT_LIBRARIES})
qt4_use_modules(ViennaCL_Benchmark Core Gui)
target_link_libraries(ViennaCL_Benchmark)

endif()


